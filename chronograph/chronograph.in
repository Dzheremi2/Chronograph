#!@PYTHON@

import gettext
import locale
import os
import signal
import sys

VERSION = "@VERSION@"
pkgdatadir = "@pkgdatadir@"
localedir = "@localedir@"

# Used in AppImage builds
appdir = os.environ.get("APPDIR")
if appdir:
  pkgdatadir = os.path.join(appdir, "usr", "share", "chronograph")
  localedir = os.path.join(appdir, "usr", "share", "locale")

sys.path.insert(1, pkgdatadir)
signal.signal(signal.SIGINT, signal.SIG_DFL)
locale.bindtextdomain("Chronograph", localedir)
locale.textdomain("Chronograph")
gettext.install("Chronograph", localedir)

if __name__ == "__main__":
  from gi.repository import Gio

  resource = Gio.Resource.load(os.path.join(pkgdatadir, "Chronograph.gresource"))
  resource._register()  # noqa: SLF001

  from chronograph import main

  sys.exit(main.main(VERSION))
